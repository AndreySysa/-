# Определение стоимости автомобилей.

[ipynb](https://github.com/AndreySysa/Portfolio/blob/main/Predicting%20the%20value%20of%20a%20car%20based%20on%20its%20VIN/Определение%20стоимости%20автомобиля%20по%20VIN.ipynb)[^1]


Перед нами стояла задача: 
- Разработка приложения, которое по VIN коду предскажет стоимость автомобиля.
***
**Описание.**

В нашем распоряжении данные предоставленные заказчиком в виде текстового документа (txt-файл), содержащего VIN и стоимость ([2FMDK3JC4BBA41556:12500])

VIN состоит из `17` знаков:
- `1-3` - производитель
- `4` - ремни безопасности для пассажирских, тормоза и грузоподъемность у тракторов
- `5-7` - модель
- `8` - двигатель
- `9` - контрольный знак
- `10` - год
- `11` - завод
- `12-17` - серийный номер

Необходимо по минимально доступному набору данных (VIN-код) построить прогнозную модель.
***
Для выполнения поставленной задачи использовались следующие библиотеки и модули:

catboost==1.0.3

joblib==1.1.0

lightgbm==3.3.1

matplotlib==3.3.4

numpy==1.21.1

optuna==3.6.1

pandas==1.2.4

phik==0.12.4

scikit-learn==0.24.1

seaborn==0.11.1

***
**Вывод:**
***
1) Визуально ознакомившись с данными пришли к выводу о не тривиальности поставленной задачи, так-как данные предоставленны в виде текстового файла вида:

'[2FMDK3JC4BBA41556:12500]РјРѕР№[3FA6P0H75ER208976:14500]РґСЏРґСЏ [3FAHP08Z17R268380:1300][1FMCU0GX3DUC59421:15200]СЃР°РјС‹С… [1FAHP2E89DG119368:11600] РІРµСЂРЅС‹С…[1FM5K8D82DGA16143:26400][1FTFW1CFXCFC23663:14000][2FMDK3JC6CBA90002:19500][1FTFW1CT8DKD06233:24400][1FMZU64W13UC28949:2900][2FMDK3JC9DBB30736:23500][1FMCU9D76CKC49193:12700][1FMCU9EG2CKA90624:20700][1FMCU0JX7EUA28208:21300][2FMGK5D85EBD31213:26700][2FMDK4KC6EBA72011:25100]РїСЂР°РІРёР» [1FTFX1EF2EKE24350:26700]' 

Всего два признака: VIN и цена.

2) Изучив структурау VIN-кода и при помощи регулярных выражений удалось получить датасет 71884 rows × 9 columns (с этим уже можно работать).
3) Исследовательский анализ показал, что:
   - Выбросов в единственном количественном признаке (`price` - цена автомобиля) нет.
   - Два из 8 признаков не влияют на стоимость автомобиля.
   - Имеется несколько уникальных значений (встречаются однократно).
4) Корреляционный анализ показал, что:
   -  все признаки линейно зависимы друг от друга.
   -  нельзя выделить признак, определяющий цену автомобиля. Без построения модели цену не расчитать.
   -  "линейные" модели не подойдут для дальнейшей работы.
   -  выбрали три модели:
         - `RandomForestRegressor` (строит множество деревьев и делает прогноз на основе их среднего значения)
         - `LGBMRegressor`(механизмы уменьшения размерности, поддерживает различные виды регуляризации, в процессе обучения случайным образом выбирает признаки для разделения на каждом узле)
         - `CatBoostRegressor`(эффективно обрабатывает категориальные признаки, используя методы, которые могут быть более устойчивы к коллинеарности, механизмы регуляризации, может автоматически уменьшать размерность данных, случайным образом выбирает признаки для разделения на каждом узле)
5) Подготовили данные, разбив на обучающий и тестовый наборы с кодировкой и без(для `CatBoostRegressor`).
6) Провели подбор гиперпараметров выбранных ранее моделей, построили для каждой график важности параметров и график истории оптимизации. Лучшим образом показала себя `LGBMRegressor`
7) Провели оценку качества модели, проверив её на тестовом наборе и сравнив с простой моделью `DummyRegressor`. Модель соответствует предъявляемым требованиям.
8) Оценка важности признаков показала:
   - больше всего на стоимость влияет год выпуска автомобиля, далее по убыванию:
        - двигатель автомобиля.
        - пакет безопасности.
        - производитель автомобиля. 
        - завод-изготовитель.
        - модель.
9) Разработали алгоритм для приложения, который:
    - Запрашивает у пользователя VIN и извлекает его компоненты.
    - Обрабатывает данные, преобразуя категориальные признаки с помощью OneHotEncoder.
    - Проверяет наличие неизвестных категорий и, если они есть, просит пользователя ввести другой VIN.
    - После успешной обработки данных делает прогноз стоимости автомобиля с помощью загруженной модели и выводит результат (приблизительную стоимость автомобиля).
   
10) На основе разработанного алгоритма и при помощи streamlit создали приложение app.py "Приложение для прогнозирования стоимости автомобилей Ford (произведенных в Северной Америке) по VIN"


[^1]:Для корректного просмотра Jupyter notebook с работающим содержанием, пожалуйста, используйте следующую ссылку:
[Прогнозирование стоимости автомобиля на основе его VIN](https://nbviewer.jupyter.org/github/AndreySysa/Portfolio/blob/main/Predicting%20the%20value%20of%20a%20car%20based%20on%20its%20VIN/Определение%20стоимости%20автомобиля%20по%20VIN.ipynb)
Просто кликните на ссылку, и nbviewer отобразит notebook с интерактивными ссылками.
