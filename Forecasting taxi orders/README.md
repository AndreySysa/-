# Прогнозирование количества заказов такси на следующий час.

[ipynb](https://github.com/AndreySysa/Portfolio/blob/main/Forecasting%20taxi%20orders/Прогнозирование%20количества%20заказов%20такси%20на%20следующий%20час.ipynb)[^1]


Перед нами стояла задача: 
- Разработка системы предсказания объема заказа.
***
Для выполнения поставленной задачи использовались следующие библиотеки и модули:
- optuna: библиотека для оптимизации гиперпараметров моделей машинного обучения.
- pandas: библиотека для работы с данными в виде таблиц (DataFrame).
- seaborn: библиотека для визуализации данных.
- lightgbm: библиотека для обучения градиентного бустинга на деревьях (LightGBM).
- matplotlib.pyplot: модуль библиотеки matplotlib для создания статических графиков и визуализаций.
- tqdm: утилита для отображения индикаторов прогресса в циклах.
- LGBMRegressor: класс из библиотеки lightgbm для обучения градиентного бустинга на деревьях.
- CatBoostRegressor: класс из библиотеки catboost для обучения градиентного бустинга на деревьях (CatBoost).
- mean_squared_error: функция из модуля metrics библиотеки sklearn для вычисления среднеквадратичной ошибки.
- LinearRegression: класс из модуля linear_model библиотеки sklearn для обучения линейной регрессии.
- RandomForestRegressor: класс из модуля ensemble библиотеки sklearn для обучения случайного леса.
- train_test_split: функция из модуля model_selection библиотеки sklearn для разделения данных на обучающую и тестовую выборки.
- seasonal_decompose: функция из библиотеки statsmodels.tsa.seasonal для декомпозиции временных рядов на сезонные, трендовые и остаточные компоненты.
***
**Вывод:**
***
- Мы выбрали модель **LGBMRegressor(feature_fraction=0.7327987020144879, lambda_l1=0.19751411429996318, lambda_l2=0.06409955640941478, learning_rate=0.09799548961674381, max_depth=20, metric='rmse', min_child_samples=5, n_estimators=84, num_leaves=161, objective='regression', random_state=12345, subsample=0.8488018358371878, subsample_freq=1)** работающую на датасете с добавлением дополнительных признаков:
- - `max_lag` - максимальное количество задержек (лагов) = 22;
- - `rolling_mean_size` - размер окна для создания скользящего среднего значения = 10
- Выбранная модель и дополнительные признаки позволяют получить предсказания, удовлетворяющие заданой точности RMSE = 40.74 < 48.


[^1]:Для корректного просмотра Jupyter notebook с работающим содержанием, пожалуйста, используйте следующую ссылку:
[Прогнозирование количества заказов такси на следующий час](https://nbviewer.jupyter.org/github/AndreySysa/Portfolio/blob/main/https://github.com/AndreySysa/Portfolio/blob/main/Forecasting%20taxi%20orders/Прогнозирование%20количества%20заказов%20такси%20на%20следующий%20час.ipynb)
Просто кликните на ссылку, и nbviewer отобразит notebook с интерактивными ссылками.